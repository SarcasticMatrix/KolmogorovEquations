forwardkolmogorov <- function(u,D){
## Spatial grid
xmax <- 10
xv <- seq(0,xmax,length=101)
dx <- diff(xv)
xc <- xv[-1] - 0.5*dx
## Discretize the generator
G <- fvade(u,D,xv,'r')
pi <- StationaryDistribution(G)
phi <- pi / dx
return(pi,Phi)
}
forwardkolmogorov(u,D)
library(SDEtools)
library(Matrix)
library(fields)
setwd('C:/Users/utilisateur/Documents/DTU/Première Année 2023-2024/Cours/Stochastic Differential Equations/Lecture 8')
source('fvade.R')
# Parameters
xi <- 2
gamma <- 1/2
lambda <- 1/2
## Drift and intensity
f <- function(x) lambda * (xi - x)
g <- function(x) gamma*sqrt(abs(x))
## Diffusivity and its spatial derivative
D <- function(x) 0.5*gamma^2*x
Dp <- function(x) 0.5*gamma^2
## Advective flow field
u <- function(x) f(x) - Dp(x)
forwardkolmogorov <- function(u,D){
## Spatial grid
xmax <- 10
xv <- seq(0,xmax,length=101)
dx <- diff(xv)
xc <- xv[-1] - 0.5*dx
## Discretize the generator
G <- fvade(u,D,xv,'r')
pi <- StationaryDistribution(G)
phi <- pi / dx
return(pi,Phi)
}
forwardkolmogorov(u,D)
forwardkolmogorov <- function(u,D){
## Spatial grid
xmax <- 10
xv <- seq(0,xmax,length=101)
dx <- diff(xv)
xc <- xv[-1] - 0.5*dx
## Discretize the generator
G <- fvade(u,D,xv,'r')
pi <- StationaryDistribution(G)
phi <- pi / dx
return(c(pi,Phi))
}
forwardkolmogorov(u,D)
c(G,phi) <- forwardkolmogorov(u,D)
list <- forwardkolmogorov(u,D)
forwardkolmogorov <- function(u,D){
## Spatial grid
xmax <- 10
xv <- seq(0,xmax,length=101)
dx <- diff(xv)
xc <- xv[-1] - 0.5*dx
## Discretize the generator
G <- fvade(u,D,xv,'r')
pi <- StationaryDistribution(G)
phi <- pi / dx
return(c(G,phi))
}
list <- forwardkolmogorov(u,D)
[1]
list
typeof(list)
return(list(G,phi))
forwardkolmogorov <- function(u,D){
## Spatial grid
xmax <- 10
xv <- seq(0,xmax,length=101)
dx <- diff(xv)
xc <- xv[-1] - 0.5*dx
## Discretize the generator
G <- fvade(u,D,xv,'r')
pi <- StationaryDistribution(G)
phi <- pi / dx
return(list(G,phi))
}
list <- forwardkolmogorov(u,D)
list
typeof(list)
G <- list[1]
phi <- list[2]
x11()
plot(xc,phi,type="l")
## Spatial grid
xmax <<- 10
xv <<- seq(0,xmax,length=101)
dx <<- diff(xv)
xc <<- xv[-1] - 0.5*dx
forwardkolmogorov <- function(u,D){
## Discretize the generator
G <- fvade(u,D,xv,'r')
pi <- StationaryDistribution(G)
phi <- pi / dx
return(list(G,phi))
}
list <- forwardkolmogorov(u,D)
G <- list[1]
phi <- list[2]
x11()
plot(xc,phi,type="l")
phi
typeof(phi)
list[1]
plot(xc,phi,type="l")
length(xc)
length(phi)
phi
phi[1]
phi[2]
forwardkolmogorov <- function(u,D){
## Discretize the generator
G <- fvade(u,D,xv,'r')
pi <- StationaryDistribution(G)
phi <- pi / dx
return(list(G,phi[1]))
}
list <- forwardkolmogorov(u,D)
G <- list[1]
phi <- list[2]
x11()
plot(xc,phi,type="l")
phi
forwardkolmogorov <- function(u,D){
## Discretize the generator
G <- fvade(u,D,xv,'r')
pi <- StationaryDistribution(G)
phi <- pi / dx
return(list(
G=G,
phi=phi))
}
list <- forwardkolmogorov(u,D)
list
list$G
G <- list$G
phi <- list$phi
x11()
plot(xc,phi,type="l")
plot(function(x)dgamma(x,rate=2*lambda/gamma^2,shape=2*lambda*xi/gamma^2),
from=0,to=xmax,add=TRUE,col="red")
setwd('C:/Users/utilisateur/Documents/DTU/Première Année 2023-2024/Cours/Stochastic Differential Equations/Lecture 8')
source('fvade.R')
source('kolmogotov-equations.R')
source('kolmogorov-equations.R')
source('kolmogorov-equations.R')
setwd('C:/Users/utilisateur/Documents/DTU/Première Année 2023-2024/Cours/Stochastic Differential Equations/KolmogorovEquations')
setwd('C:/Users/utilisateur/Documents/DTU/Première Année 2023-2024/Cours/Stochastic Differential Equations/KolmogorovEquations')
source('fvade.R')
source('kolmogorov-equations.R')
